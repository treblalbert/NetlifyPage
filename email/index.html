<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Albert's Workspace</title>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/animations.css">
</head>
<body>
    <!-- Animated Wave Background -->
    <div class="waves-background">
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
    </div>

    <!-- Header -->
    <div class="header">
        <h1>ğŸš€ Albert's Workspace</h1>
        <div class="header-actions">
            <button class="ai-chat-btn" onclick="openAIChat()">ğŸ¤– Albert's Assistant</button>
            <button class="notes-btn" onclick="openNotes()">ğŸ“ Personal Notes</button>
            <button class="add-account-btn" onclick="addAccount()">+ Add Account</button>
        </div>
    </div>
    
    <!-- Accounts Container -->
    <div class="accounts-container" id="accountsContainer">
        <div class="account-panel">
            <div class="auth-prompt" id="authPrompt">
                <h2>Welcome to Your Workspace</h2>
                <p>First, upload your Google credentials JSON file</p>
                <input type="file" id="credentialsFile" accept=".json" style="display: none;" onchange="loadCredentials(event)">
                <button class="auth-btn" onclick="document.getElementById('credentialsFile').click()">ğŸ“ Upload Credentials</button>
                <div id="credentialsStatus" style="margin-top: 15px; color: rgba(255,255,255,0.8); font-size: 14px;"></div>
            </div>
        </div>
    </div>
    
    <!-- Email View Modal -->
    <div class="email-modal" id="emailModal" onclick="if(event.target === this) closeEmailModal()">
        <div class="email-modal-content">
            <div class="email-modal-header">
                <div>
                    <div class="email-modal-subject" id="emailModalSubject">Subject</div>
                    <div class="email-modal-from" id="emailModalFrom">From</div>
                    <div class="email-modal-date" id="emailModalDate">Date</div>
                </div>
                <button class="action-btn" onclick="closeEmailModal()">âœ•</button>
            </div>
            <div class="email-modal-body" id="emailModalBody">Loading...</div>
            <div class="email-modal-footer">
                <button class="btn-primary" id="replyBtn">â†©ï¸ Reply</button>
                <button class="btn-secondary" onclick="closeEmailModal()">Close</button>
            </div>
        </div>
    </div>
    
    <!-- Compose Modal -->
    <div class="compose-modal" id="composeModal" onclick="if(event.target === this) closeCompose()">
        <div class="compose-content">
            <div class="compose-header">
                <h3 style="color: white; margin: 0;">New Message</h3>
                <button class="action-btn" style="color: white; border-color: rgba(255, 255, 255, 0.2);" onclick="closeCompose()">âœ•</button>
            </div>
            <div class="compose-body">
                <div style="color: rgba(255, 255, 255, 0.7); font-size: 14px;">From: <span id="composeFrom" style="color: white; font-weight: 500;"></span></div>
                <input type="email" class="compose-input" id="composeTo" placeholder="To">
                <input type="text" class="compose-input" id="composeSubject" placeholder="Subject">
                <textarea class="compose-textarea" id="composeBody" placeholder="Write your message..."></textarea>
            </div>
            <div class="compose-footer">
                <button class="btn-primary" onclick="sendEmail()">ğŸ“¤ Send</button>
                <button class="btn-secondary" onclick="closeCompose()">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Notes Modal -->
    <div class="notes-modal" id="notesModal" onclick="if(event.target === this) closeNotes()">
        <div class="notes-content">
            <div class="notes-header">
                <h3 style="color: white; margin: 0;">Personal Notes</h3>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div class="auto-save-indicator" id="autoSaveIndicator">
                        <span id="saveStatus">Auto-save enabled</span>
                    </div>
                    <button class="action-btn" style="color: white; border-color: rgba(255, 255, 255, 0.2);" onclick="closeNotes()">âœ•</button>
                </div>
            </div>
            <div class="notes-body">
                <div class="notes-actions">
                    <input type="file" id="notesFile" accept=".md,.txt" style="display: none;" onchange="loadNotesFile(event)">
                    <button class="btn-primary" onclick="openNotesFile()">ğŸ“‚ Open Notes File</button>
                    <button class="btn-secondary" id="editNotesBtn" onclick="toggleEditMode()">âœï¸ Edit</button>
                    <button class="btn-secondary" onclick="clearNotes()">ğŸ—‘ï¸ Clear Notes</button>
                </div>
                <div class="notes-content-text" id="notesContent">
                    No notes loaded. Click "Open Notes File" to load a markdown file.
                </div>
                <textarea class="notes-edit-textarea" id="notesEditTextarea" style="display: none;" oninput="handleNotesChange()"></textarea>
            </div>
            <div class="notes-footer">
                <div style="color: rgba(255, 255, 255, 0.6); font-size: 12px; margin-right: auto;">
                    <span id="currentFileName">No file selected</span>
                </div>
                <button class="btn-secondary" onclick="closeNotes()">Close</button>
            </div>
        </div>
    </div>
    
    <!-- AI Chat Modal -->
    <div class="ai-chat-modal" id="aiChatModal" onclick="if(event.target === this) closeAIChat()">
        <div class="ai-chat-content">
            <div class="ai-chat-header">
                <h3 style="color: white; margin: 0;">ğŸ¤– Albert's Assistant</h3>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="color: rgba(255, 255, 255, 0.7); font-size: 12px;">
                        <span id="apiKeyStatus">API Key: Not Loaded</span>
                    </div>
                    <button class="action-btn" style="color: white; border-color: rgba(255, 255, 255, 0.2);" onclick="closeAIChat()">âœ•</button>
                </div>
            </div>
            <div class="ai-chat-body">
                <div class="ai-chat-actions">
                    <input type="file" id="apiKeyFile" accept=".txt" style="display: none;" onchange="loadAPIKey(event)">
                    <button class="btn-primary" onclick="document.getElementById('apiKeyFile').click()">ğŸ”‘ Load API Key</button>
                    <button class="btn-secondary" onclick="clearChat()">ğŸ—‘ï¸ Clear Chat</button>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <div class="message assistant">
                        <div class="sender">Albert's Assistant</div>
                        <div class="content">Good day, Sir Albert! I'm at your service. How may I assist you today?</div>
                    </div>
                </div>
                <div class="typing-indicator" id="typingIndicator">Albert's Assistant is typing...</div>
                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Type your message to Albert's Assistant..." onkeypress="handleChatInput(event)">
                    <button class="btn-primary" onclick="sendChatMessage()">Send</button>
                </div>
            </div>
            <div class="ai-chat-footer">
                <div style="color: rgba(255, 255, 255, 0.6); font-size: 12px; margin-right: auto;">
                    Powered by OpenAI GPT
                </div>
                <button class="btn-secondary" onclick="closeAIChat()">Close</button>
            </div>
        </div>
    </div>

    <!-- Google Sign-In Script -->
    <script src="https://accounts.google.com/gsi/client"></script>
    
    <!-- Application Scripts -->
    <script src="js/config.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/gmail.js"></script>
    <script src="js/notes.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/main.js"></script>
</body>
</html>