<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LENIMKI | Management Portal</title>
    <style>
        /* Modern Professional Theme - No Hacker Terminal Aesthetic */
        :root {
            --primary: #2563eb;
            --primary-hover: #1d4ed8;
            --bg-body: #f1f5f9;
            --bg-card: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --weapon-red: #dc2626;
            --food-green: #16a34a;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
        }

        .dashboard-container {
            max-width: 1100px;
            margin: 0 auto;
            background: var(--bg-card);
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            border: 1px solid var(--border);
            overflow: hidden;
        }

        /* Tabs Navigation */
        .tabs-header {
            display: flex;
            background: #f8fafc;
            border-bottom: 1px solid var(--border);
            padding: 0 20px;
        }

        .tab-btn {
            padding: 16px 24px;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-muted);
            border-bottom: 2px solid transparent;
            transition: 0.2s;
        }

        .tab-btn.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content { display: none; padding: 30px; }
        .tab-content.active { display: block; }

        /* Database Styles */
        .controls { 
            display: flex; gap: 10px; margin-bottom: 20px; 
            background: #f8fafc; padding: 15px; border-radius: 8px; flex-wrap: wrap;
        }
        
        .search-bar { 
            margin-bottom: 20px; padding: 12px; border: 1px solid var(--border); 
            border-radius: 8px; display: flex; align-items: center; gap: 10px;
            background: white;
        }
        
        .search-bar input { border: none; outline: none; width: 100%; font-size: 1rem; }

        input, select, button { 
            padding: 10px 12px; border: 1px solid var(--border); border-radius: 6px; 
            font-family: inherit;
        }

        .btn-add { background: var(--primary); color: white; border: none; cursor: pointer; font-weight: bold; }
        .btn-save { background: #0f172a; color: white; width: 100%; padding: 15px; margin-top: 20px; cursor: pointer; font-weight: bold; border: none; border-radius: 8px; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { text-align: left; padding: 12px; background: #f8fafc; border-bottom: 2px solid var(--border); color: var(--text-muted); font-size: 0.85rem; text-transform: uppercase; }
        td { padding: 12px; border-bottom: 1px solid var(--border); }

        /* Detail Panels - Exact Logic from Original */
        .expandable { cursor: pointer; }
        .expandable:hover { background: #f8fafc; }
        .details-panel { background: #fafafa !important; padding: 0; border-bottom: 2px solid var(--border); }
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; padding: 20px; }
        .stat-item { display: flex; flex-direction: column; }
        .stat-label { font-size: 0.7rem; text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px; }
        .stat-val { font-weight: bold; font-size: 0.95rem; font-family: monospace; }
        .val-weapon { color: var(--weapon-red); }
        .val-food { color: var(--food-green); }

        /* Keyboard Controls Styling */
        .controls-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
        .key-row { display: flex; align-items: center; margin-bottom: 15px; }
        .key-cap { 
            background: #fff; border: 1px solid #cbd5e1; border-radius: 6px; 
            padding: 6px 12px; min-width: 50px; text-align: center; font-weight: 700; 
            box-shadow: 0 3px 0 #94a3b8; margin-right: 15px; font-family: monospace;
        }
        .status-msg { margin-top: 10px; font-size: 0.85rem; color: var(--text-muted); font-style: italic; }
    </style>
</head>
<body>

<div class="dashboard-container">
    <div class="tabs-header">
        <button class="tab-btn active" onclick="openTab(event, 'database')">Database Management</button>
        <button class="tab-btn" onclick="openTab(event, 'controls')">Game Controls</button>
    </div>

    <div id="database" class="tab-content active">
        <h1 style="font-size: 1.25rem; margin-bottom: 20px;">LENIMKI Database Loader</h1>
        
        <div class="controls">
            <input type="number" id="itemId" placeholder="ID" style="width: 60px;">
            <input type="text" id="itemName" placeholder="Item Name" style="flex-grow: 1;">
            <input type="number" id="itemPrice" placeholder="Larks" style="width: 80px;">
            <input type="text" id="itemWeight" placeholder="0.00KG" style="width: 100px;">
            <select id="itemType">
                <option value="Food">Food</option>
                <option value="Misc">Misc</option>
                <option value="Ammo">Ammo</option>
                <option value="Weapon">Weapon</option>
            </select>
            <button class="btn-add" onclick="addItem()">+ ADD ITEM</button>
        </div>

        <div class="search-bar">
            <span style="color: var(--text-muted)">SEARCH:</span>
            <input type="text" id="searchInput" placeholder="Search by name or type..." onkeyup="renderTable()">
        </div>

        <table id="itemTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Weight</th>
                    <th>Price (Larks)</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>

        <button class="btn-save" onclick="downloadJSON()">üíæ EXPORT UPDATED ITEMS.JSON</button>
        <div id="status" class="status-msg">System: Initializing...</div>
    </div>

    <div id="controls" class="tab-content">
        <h1 style="font-size: 1.25rem; margin-bottom: 20px;">Reference: Player Controls</h1>
        <div class="controls-grid">
            <div>
                <h2 style="color:var(--primary); font-size: 0.9rem; border-bottom: 1px solid var(--border); padding-bottom: 8px; margin-bottom: 20px; text-transform: uppercase;">Movement</h2>
                <div class="key-row"><div class="key-cap">WASD</div><div class="key-desc">Movement</div></div>
                <div class="key-row"><div class="key-cap">SHIFT</div><div class="key-desc">Run / Sprint</div></div>
                <div class="key-row"><div class="key-cap">SPACE</div><div class="key-desc">Jump</div></div>
                <div class="key-row"><div class="key-cap">CTRL</div><div class="key-desc">Crouch <br><small style="color:var(--text-muted)">Scroll Wheel: Adjust Height</small></div></div>
                <div class="key-row"><div class="key-cap">Q / E</div><div class="key-desc">Lean Left / Right</div></div>
            </div>
            <div>
                <h2 style="color:var(--primary); font-size: 0.9rem; border-bottom: 1px solid var(--border); padding-bottom: 8px; margin-bottom: 20px; text-transform: uppercase;">Combat & UI</h2>
                <div class="key-row"><div class="key-cap">LMB</div><div class="key-desc">Shoot / Attack</div></div>
                <div class="key-row"><div class="key-cap">RMB</div><div class="key-desc">Aim Down Sights</div></div>
                <div class="key-row"><div class="key-cap">1</div><div class="key-desc">Secondary Weapon</div></div>
                <div class="key-row"><div class="key-cap">2 , 3</div><div class="key-desc">Main Weapons</div></div>
                <div class="key-row"><div class="key-cap">H</div><div class="key-desc">Holster</div></div>
                <div class="key-row"><div class="key-cap">F</div><div class="key-desc">Interact</div></div>
                <div class="key-row"><div class="key-cap">TAB</div><div class="key-desc">Inventory</div></div>
            </div>
        </div>
    </div>
</div>

<script>
    // TAB SYSTEM
    function openTab(evt, tabName) {
        let i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tab-content");
        for (i = 0; i < tabcontent.length; i++) tabcontent[i].classList.remove("active");
        tablinks = document.getElementsByClassName("tab-btn");
        for (i = 0; i < tablinks.length; i++) tablinks[i].classList.remove("active");
        document.getElementById(tabName).classList.add("active");
        evt.currentTarget.classList.add("active");
    }

    // ORIGINAL DATA HANDLING
    let items = [];

    async function loadData() {
        const status = document.getElementById('status');
        try {
            const response = await fetch('items.json');
            items = await response.json();
            status.innerText = "System: items.json loaded successfully.";
            renderTable();
        } catch (err) {
            status.innerHTML = "<span style='color:red'>Error: Could not find items.json in root folder.</span>";
        }
    }

    function renderTable() {
        const tbody = document.getElementById('tableBody');
        const filter = document.getElementById('searchInput').value.toLowerCase();
        tbody.innerHTML = '';
        
        items.sort((a, b) => a.id - b.id);
        
        items.forEach((item) => {
            if (!item.name.toLowerCase().includes(filter) && !item.type.toLowerCase().includes(filter)) return;

            const isWeapon = item.type === 'Weapon' && item.stats;
            const isFood = item.type === 'Food' && item.consumable;
            const expandableClass = (isWeapon || isFood) ? 'expandable' : '';

            const tr = document.createElement('tr');
            if (expandableClass) {
                tr.className = expandableClass;
                tr.onclick = () => toggleDetails(item.id);
            }
            
            tr.innerHTML = `
                <td><strong>${item.id}</strong></td>
                <td>${item.name} ${(isWeapon || isFood) ? '<span style="font-size:0.7em; color:var(--text-muted); margin-left:8px;">[DETAILS]</span>' : ''}</td>
                <td><span style="color: ${getTypeColor(item.type)}; font-weight: 600;">${item.type}</span></td>
                <td style="color:var(--text-muted)">${item.weight || '0.00KG'}</td>
                <td style="color:#b45309; font-weight: 500;">≈Å ${item.price || 0}</td>
                <td><button onclick="event.stopPropagation(); removeItem(${item.id})" style="color:red; border:none; background:none; cursor:pointer; font-weight:bold;">DEL</button></td>
            `;
            tbody.appendChild(tr);

            // Re-adding the Full Stats Panels
            if (isWeapon || isFood) {
                const detailsTr = document.createElement('tr');
                detailsTr.id = `details-${item.id}`;
                detailsTr.style.display = 'none';
                
                let innerContent = '';
                if (isWeapon) {
                    innerContent = `
                        <div class="stats-grid">
                            <div class="stat-item"><span class="stat-label">Ammo Type</span><span class="stat-val val-weapon">${item.stats.ammo} (#${item.stats.ammoId})</span></div>
                            <div class="stat-item"><span class="stat-label">Fire Rate</span><span class="stat-val val-weapon">${item.stats.fireRate}s</span></div>
                            <div class="stat-item"><span class="stat-label">Damage</span><span class="stat-val val-weapon">${item.stats.damage}/100</span></div>
                            <div class="stat-item"><span class="stat-label">Range</span><span class="stat-val val-weapon">${item.stats.range}m</span></div>
                            <div class="stat-item"><span class="stat-label">Spread</span><span class="stat-val val-weapon">${item.stats.spread}¬∞</span></div>
                            <div class="stat-item"><span class="stat-label">Pellets</span><span class="stat-val val-weapon">${item.stats.pellets}</span></div>
                        </div>`;
                } else {
                    innerContent = `
                        <div class="stats-grid">
                            <div class="stat-item"><span class="stat-label">Hunger Restore</span><span class="stat-val val-food">+${item.consumable.hunger}/100</span></div>
                            <div class="stat-item"><span class="stat-label">Stamina Boost</span><span class="stat-val val-food">+${item.consumable.stamina}/100</span></div>
                            <div class="stat-item"><span class="stat-label">Health Regen</span><span class="stat-val val-food">+${item.consumable.health}/100</span></div>
                        </div>`;
                }

                detailsTr.innerHTML = `<td colspan="6" class="details-panel">${innerContent}</td>`;
                tbody.appendChild(detailsTr);
            }
        });
    }

    function toggleDetails(id) {
        const row = document.getElementById(`details-${id}`);
        if(row) row.style.display = row.style.display === 'none' ? 'table-row' : 'none';
    }

    function getTypeColor(type) {
        switch(type) {
            case 'Weapon': return '#dc2626';
            case 'Food': return '#16a34a';
            case 'Ammo': return '#ca8a04';
            case 'Misc': return '#2563eb';
            default: return '#1e293b';
        }
    }

    function addItem() {
        const id = document.getElementById('itemId').value;
        const name = document.getElementById('itemName').value;
        const price = document.getElementById('itemPrice').value;
        const weight = document.getElementById('itemWeight').value || "0.00KG";
        const type = document.getElementById('itemType').value;

        if(id && name && price) {
            items.push({ 
                id: parseInt(id), 
                name, 
                type, 
                price: parseInt(price), 
                weight: weight.toUpperCase().includes('KG') ? weight.toUpperCase() : weight + "KG" 
            });
            renderTable();
            ['itemId', 'itemName', 'itemPrice', 'itemWeight'].forEach(f => document.getElementById(f).value = '');
        }
    }

    function removeItem(id) {
        items = items.filter(item => item.id !== id);
        renderTable();
    }

    function downloadJSON() {
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(items, null, 2));
        const downloadAnchorNode = document.createElement('a');
        downloadAnchorNode.setAttribute("href", dataStr);
        downloadAnchorNode.setAttribute("download", "items.json");
        document.body.appendChild(downloadAnchorNode);
        downloadAnchorNode.click();
        downloadAnchorNode.remove();
    }

    loadData();
</script>
</body>
</html>